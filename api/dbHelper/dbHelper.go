package dbHelper

import (
	"database/sql"
	"log"
)

func PopulateDb(db *sql.DB){

	// create the city table
	createTable := `CREATE TABLE IF NOT EXISTS city (
		id SERIAL PRIMARY KEY,
		department_code VARCHAR(6) UNIQUE NOT NULL,
		insee_code VARCHAR(5) NOT NULL,
		zip_code VARCHAR(5) NOT NULL,
		name VARCHAR(255) NOT NULL,
		lat FLOAT NOT NULL, 
		lon FLOAT NOT NULL
	);`

	_, err := db.Exec(createTable)
	if err != nil {
		log.Println("Error creating table:", err)
	}

	sqlStatementInsert := `INSERT INTO city (department_code, insee_code, zip_code, name, lat, lon)
	VALUES
	('01', '01001', '01000', 'Bourg-en-Bresse', 46.2051, 5.2250),
	  ('02', '02001', '02000', 'Laon', 49.5610, 3.6100),
	  ('03', '03001', '03000', 'Moulins', 46.5669, 3.3375),
	  ('04', '04001', '04000', 'Digne-les-Bains', 44.0924, 6.2357),
	  ('05', '05001', '05000', 'Gap', 44.5593, 6.0796),
	  ('06', '06001', '06000', 'Nice', 43.7102, 7.2620),
	  ('07', '07001', '07000', 'Privas', 44.7350, 4.6000),
	  ('08', '08001', '08000', 'Charleville-Mézières', 49.7645, 4.7190),
	  ('09', '09001', '09000', 'Foix', 42.9647, 1.6114),
	  ('10', '10001', '10000', 'Troyes', 48.2965, 4.0741),
	  ('11', '11001', '11000', 'Carcassonne', 43.2159, 2.3518),
	  ('12', '12001', '12000', 'Rodez', 44.3500, 2.5700),
	  ('13', '13001', '13000', 'Marseille', 43.2965, 5.3698),
	  ('14', '14001', '14000', 'Caen', 49.1829, -0.3700),
	  ('15', '15001', '15000', 'Aurillac', 44.9269, 2.4447),
	  ('16', '16001', '16000', 'Angoulême', 45.6496, 0.1600),
	  ('17', '17001', '17000', 'La Rochelle', 46.1604, -1.1518),
	  ('18', '18001', '18000', 'Bourges', 47.0823, 2.3964),
	  ('19', '19001', '19000', 'Tulle', 45.2673, 1.7664),
	  ('20', '20001', '20000', 'Ajaccio', 41.9260, 8.7376),
	  ('21', '21001', '21000', 'Dijon', 47.3216, 5.0415),
	  ('22', '22001', '22000', 'Saint-Brieuc', 48.5142, -2.7653),
	  ('23', '23001', '23000', 'Guéret', 46.1670, 1.8795),
	  ('24', '24001', '24000', 'Périgueux', 45.1847, 0.7212),
	  ('25', '25001', '25000', 'Besançon', 47.2380, 6.0243),
	  ('26', '26001', '26000', 'Valence', 44.9335, 4.8900),
	  ('27', '27001', '27000', 'Évreux', 49.0293, 1.1501),
	  ('28', '28001', '28000', 'Chartres', 48.4439, 1.4890),
	  ('29', '29001', '29000', 'Quimper', 48.0000, -4.1000),
	  ('30', '30001', '30000', 'Nîmes', 43.8374, 4.3601),
	  ('31', '31001', '31000', 'Toulouse', 43.6045, 1.4440),
	  ('32', '32001', '32000', 'Auch', 43.6465, 0.5834),
	  ('33', '33001', '33000', 'Bordeaux', 44.8378, -0.5792),
	  ('34', '34001', '34000', 'Montpellier', 43.6119, 3.8772),
	  ('35', '35001', '35000', 'Rennes', 48.1135, -1.6750),
	  ('36', '36001', '36000', 'Châteauroux', 46.8102, 1.6914),
	  ('37', '37001', '37000', 'Tours', 47.3941, 0.6848),
	  ('38', '38001', '38000', 'Grenoble', 45.1885, 5.7245),
	  ('39', '39001', '39000', 'Lons-le-Saunier', 46.6711, 5.5510),
	  ('40', '40001', '40000', 'Mont-de-Marsan', 43.8904, -0.4998),
	  ('41', '41001', '41000', 'Blois', 47.5861, 1.3359),
	  ('42', '42001', '42000', 'Saint-Étienne', 45.4397, 4.3872),
	  ('43', '43001', '43000', 'Le Puy-en-Velay', 45.0414, 3.8857),
	  ('44', '44001', '44000', 'Nantes', 47.2181, -1.5528),
	  ('45', '45001', '45000', 'Orléans', 47.9030, 1.9093),
	  ('46', '46001', '46000', 'Cahors', 44.4448, 1.4409),
	  ('47', '47001', '47000', 'Agen', 44.2030, 0.6160),
	  ('48', '48001', '48000', 'Mende', 44.5197, 3.4990),
	  ('49', '49001', '49000', 'Angers', 47.4734, -0.5586),
	  ('50', '50001', '50000', 'Saint-Lô', 49.1167, -1.0833),
	  ('51', '51001', '51000', 'Châlons-en-Champagne', 48.9563, 4.3632),
	  ('52', '52001', '52000', 'Chaumont', 48.1133, 5.1390),
	  ('53', '53001', '53000', 'Laval', 48.0736, -0.7686),
	  ('54', '54001', '54000', 'Nancy', 48.6921, 6.1844),
	  ('55', '55001', '55000', 'Bar-le-Duc', 48.7742, 5.1648),
	  ('56', '56001', '56000', 'Vannes', 47.6609, -2.7600),
	  ('57', '57001', '57000', 'Metz', 49.1197, 6.1767),
	  ('58', '58001', '58000', 'Nevers', 46.9869, 3.1624),
	  ('59', '59001', '59000', 'Lille', 50.6293, 3.0573),
	  ('60', '60001', '60000', 'Beauvais', 49.4285, 2.8241),
	  ('61', '61001', '61000', 'Alençon', 48.4355, 0.0991),
	  ('62', '62001', '62000', 'Arras', 50.2910, 2.7770),
	  ('63', '63001', '63000', 'Clermont-Ferrand', 45.7772, 3.0870),
	  ('64', '64001', '64000', 'Pau', 43.2992, -0.3700),
	  ('65', '65001', '65000', 'Tarbes', 43.2333, 0.0833),
	  ('66', '66001', '66000', 'Perpignan', 42.6986, 2.8955),
	  ('67', '67001', '67000', 'Strasbourg', 48.5839, 7.7455),
	  ('68', '68001', '68000', 'Colmar', 48.0783, 7.3574),
	  ('69', '69001', '69000', 'Lyon', 45.7578, 4.8320),
	  ('70', '70001', '70000', 'Vesoul', 47.6196, 6.1544),
	  ('71', '71001', '71000', 'Mâcon', 46.3074, 4.8330),
	  ('72', '72001', '72000', 'Le Mans', 47.9959, 0.1922),
	  ('73', '73001', '73000', 'Chambéry', 45.5653, 5.9178),
	  ('74', '74001', '74000', 'Annecy', 45.8992, 6.1294),
	  ('75', '75001', '75000', 'Paris', 48.8566, 2.3522),
	  ('76', '76001', '76000', 'Rouen', 49.4431, 1.0993),
	  ('77', '77001', '77000', 'Melun', 48.5393, 2.6557),
	  ('78', '78001', '78000', 'Versailles', 48.8048, 2.1204),
	  ('79', '79001', '79000', 'Niort', 46.3237, -0.4647),
	  ('80', '80001', '80000', 'Amiens', 49.8942, 2.3022),
	  ('81', '81001', '81000', 'Albi', 43.9261, 2.1483),
	  ('82', '82001', '82000', 'Montauban', 44.0167, 1.3500),
	  ('83', '83001', '83000', 'Toulon', 43.1257, 5.9300),
	  ('84', '84001', '84000', 'Avignon', 43.9493, 4.8059),
	  ('85', '85001', '85000', 'La Roche-sur-Yon', 46.6705, -1.4260),
	  ('86', '86001', '86000', 'Poitiers', 46.5802, 0.3400),
	  ('87', '87001', '87000', 'Limoges', 45.8336, 1.2611),
	  ('88', '88001', '88000', 'Épinal', 48.1765, 6.4511),
	  ('89', '89001', '89000', 'Auxerre', 47.7974, 3.5668),
	  ('90', '90001', '90000', 'Belfort', 47.6388, 6.8627),
	  ('91', '91001', '91000', 'Évry', 48.6290, 2.4545),
	  ('92', '92001', '92000', 'Nanterre', 48.8924, 2.2167),
	  ('93', '93001', '93000', 'Bobigny', 48.9061, 2.4475),
	  ('94', '94001', '94000', 'Créteil', 48.7904, 2.4588),
	  ('95', '95001', '95000', 'Pontoise', 49.0516, 2.1030),
	  ('971', '97101', '97100', 'Basse-Terre', 15.9985, -61.7250),
	  ('972', '97201', '97200', 'Fort-de-France', 14.6089, -61.0733),
	  ('973', '97301', '97300', 'Cayenne', 4.9226, -52.3260),
	  ('974', '97401', '97400', 'Saint-Denis', -20.8823, 55.4504),
	  ('976', '97601', '97600', 'Mamoudzou', -12.7808, 45.2279);
	
	`
	_, errQuery := db.Exec(sqlStatementInsert)
	if errQuery != nil {
		log.Println("Error executing SQL query:", errQuery)
		return
	}

	println("Table setup done")

}
